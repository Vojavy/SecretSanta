# Руководство по запуску проекта с использованием Docker

Добро пожаловать! В этом руководстве вы найдете пошаговые инструкции по запуску нашего проекта, состоящего из фронтенда на React и бэкенда на PHP, с использованием Docker и Docker Compose. В конце этого руководства вы сможете открыть фронтенд и бэкенд в браузере и взаимодействовать с приложением.

---

## Предварительные требования

Перед началом убедитесь, что на вашем компьютере установлены следующие программы:

1. **Docker**: Платформа для разработки, отправки и запуска приложений в контейнерах.
2. **Docker Compose**: Инструмент для определения и запуска многоконтейнерных Docker-приложений.

### Установка Docker и Docker Compose

- **Windows и macOS**:

  - Загрузите и установите **Docker Desktop** с официального сайта: [Docker Desktop Download](https://www.docker.com/products/docker-desktop).

- **Linux**:

  - Следуйте официальной инструкции по установке Docker Engine: [Docker Engine Install](https://docs.docker.com/engine/install/).
  - Установите Docker Compose: [Docker Compose Install](https://docs.docker.com/compose/install/).

После установки Docker проверьте, что все работает корректно, выполнив команду:

```bash
docker --version
docker-compose --version
```

---

## Структура проекта

Наш проект имеет следующую структуру:

- **react-frontend/**: Директория с кодом фронтенда на React.
- **php-backend/**: Директория с кодом бэкенда на PHP.
- **postgresql-database/**:
  - **db-init/**: Директория со скриптами инициализации базы данных Postgres.
- **docker-compose.yml**: Файл для конфигурации Docker Compose.

---

## Шаг 1: Клонирование репозитория проекта

Если проект хранится в системе контроля версий (например, Git), клонируйте репозиторий на свой компьютер:

```bash
git clone <URL_репозитория>
```

Перейдите в директорию проекта:

```bash
cd <имя_проекта>
```

---

## Шаг 2: Настройка окружения

### 2.1. Проверка файлов Docker

Убедитесь, что в соответствующих директориях присутствуют следующие файлы:

- **react-frontend/Dockerfile**
- **php-backend/Dockerfile**
- **docker-compose.yml**
- Скрипты инициализации базы данных в **postgresql-database/db-init/**

### 2.2. Настройка переменных окружения (опционально)

Если ваш проект использует переменные окружения, создайте файл `.env` в корневой директории и добавьте необходимые переменные.

---

## Шаг 3: Запуск проекта с помощью Docker Compose

В корневой директории проекта выполните следующую команду:

```bash
docker-compose up --build
```

Эта команда:

- Соберет Docker-образы для фронтенда и бэкенда.
- Запустит контейнеры для фронтенда, бэкенда и базы данных.
- Отобразит логи всех сервисов в терминале.

### Флаги команды:

- `up`: Запускает сервисы, определенные в `docker-compose.yml`.
- `--build`: Форсирует пересборку образов.

---

## Шаг 4: Проверка работы сервисов

После успешного запуска Docker Compose вы можете проверить работу сервисов.

### 4.1. Фронтенд (React)

- Откройте браузер и перейдите по адресу:

  ```
  http://localhost:3000
  ```

- Вы должны увидеть интерфейс вашего React-приложения.

### 4.2. Бэкенд (PHP)

- Откройте новую вкладку браузера и перейдите по адресу:

  ```
  http://localhost:8080
  ```

- В зависимости от вашего приложения, вы можете увидеть API-эндпоинты или страницу приветствия.

### 4.3. База данных (Postgres)

- По умолчанию база данных доступна на порту `5432`.
- Вы можете подключиться к ней с помощью инструментов, таких как **pgAdmin**, **DBeaver** или командной строки `psql`.

---

## Шаг 5: Управление контейнерами

### 5.1. Остановка сервисов

Чтобы остановить все запущенные сервисы, нажмите `Ctrl+C` в терминале, где выполняется `docker-compose up`.

Затем выполните:

```bash
docker-compose down
```

Это остановит и удалит контейнеры, но сохранит тома данных.

### 5.2. Просмотр запущенных контейнеров

Вы можете проверить, какие контейнеры запущены, с помощью команды:

```bash
docker ps
```

### 5.3. Перезапуск сервисов

Если вы внесли изменения в код и хотите перезапустить сервисы:

```bash
docker-compose up --build
```

---

## Шаг 6: Отладка и логирование

### 6.1. Просмотр логов

Вы можете просматривать логи конкретного сервиса:

```bash
docker-compose logs -f <имя_сервиса>
```

Например, для просмотра логов бэкенда:

```bash
docker-compose logs -f php-backend
```

### 6.2. Доступ к контейнеру

Чтобы попасть внутрь запущенного контейнера:

```bash
docker exec -it <имя_контейнера> /bin/bash
```

Например, для бэкенда:

```bash
docker exec -it php-backend /bin/bash
```

---

## Дополнительные сведения

### 7.1. Изменение кода на лету

Благодаря использованию **volumes** в `docker-compose.yml`, изменения в коде на вашем компьютере сразу отражаются внутри контейнера. Это удобно для разработки и тестирования.

### 7.2. Управление базой данных

- Скрипты в директории `postgresql-database/db-init` выполняются только при первом запуске контейнера базы данных.
- Если вам нужно повторно инициализировать базу данных, удалите том `pgdata`:

  ```bash
  docker-compose down -v
  ```

  **Внимание**: Это удалит все данные в базе данных.

---

## Часто задаваемые вопросы

### Q1: Что делать, если порт уже занят?

Если при запуске вы получаете ошибку о том, что порт уже занят, вам нужно изменить порты в файле `docker-compose.yml` или освободить занятый порт.

### Q2: Как изменить конфигурацию базы данных?

Вы можете изменить переменные окружения для базы данных в `docker-compose.yml`:

```yaml
environment:
  POSTGRES_USER: your_user
  POSTGRES_PASSWORD: your_password
  POSTGRES_DB: your_db
```

Также не забудьте обновить настройки подключения в вашем бэкенде.

### Q3: Как добавить новые зависимости в проект?

- **Фронтенд**:

  - Войдите в контейнер фронтенда:

    ```bash
    docker exec -it react-frontend /bin/bash
    ```

  - Установите зависимости с помощью `npm` или `yarn`.

- **Бэкенд**:

  - Войдите в контейнер бэкенда:

    ```bash
    docker exec -it php-backend /bin/bash
    ```

  - Установите необходимые расширения или пакеты.

---

## Заключение

Поздравляем! Теперь вы знаете, как запустить и использовать наш проект с помощью Docker и Docker Compose. Если у вас возникнут вопросы или проблемы, не стесняйтесь обращаться за помощью.

---

**Полезные команды:**

- Запуск сервисов:

  ```bash
  docker-compose up --build
  ```

- Остановка сервисов:

  ```bash
  docker-compose down
  ```

- Просмотр запущенных контейнеров:

  ```bash
  docker ps
  ```

- Просмотр логов сервиса:

  ```bash
  docker-compose logs -f <имя_сервиса>
  ```

- Доступ к контейнеру:

  ```bash
  docker exec -it <имя_контейнера> /bin/bash
  ```

---

**Контакты для поддержки:**

- **Email**: 
- **Телефон**: знаете

Спасибо за внимание и удачной работы!